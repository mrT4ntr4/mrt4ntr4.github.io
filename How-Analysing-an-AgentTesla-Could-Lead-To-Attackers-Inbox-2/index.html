<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta property="og:type" content="article">
<meta property="og:title" content="How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II">
<meta property="og:url" content="https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/index.html">
<meta property="og:site_name" content="mrT4ntr4&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/thumb2.png">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e27.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e28.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e29.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e30.PNG">
<meta property="og:image" content="https://media.giphy.com/media/cjT17PDuM7azm/giphy.gif">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e31.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e32.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e33.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e34.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e35.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e36.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e37.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e38.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e59.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e39.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e40.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e41.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e42.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e44.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e45.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e46.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e48.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e47.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e52.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e53.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e54.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/gg1.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/gg2.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/gg3.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e55.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e56.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e57.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e58.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e60.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e61.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e62.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e63.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e64.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e65.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e67.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e68.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e69.PNG">
<meta property="og:image" content="https://media.giphy.com/media/OdHeYw7XBk6EE/giphy.gif">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e70.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e71.PNG">
<meta property="og:image" content="https://mrt4ntr4.github.io/img/MA/sample1/e72.PNG">
<meta property="article:published_time" content="2020-04-15T01:00:00.000Z">
<meta property="article:modified_time" content="2020-12-30T07:05:57.193Z">
<meta property="article:author" content="Suraj Malhotra">
<meta property="article:tag" content="AgentTesla">
<meta property="article:tag" content="Malware">
<meta property="article:tag" content=".Net">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mrt4ntr4.github.io/img/MA/sample1/thumb2.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
        
      
    
    <!-- title -->
    <title>How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/feed.xml" title="mrT4ntr4&#39;s Blog" type="application/atom+xml" />
    
<meta name="generator" content="Hexo 5.3.0"></head>

<div class="background">
    <div class="banner">
<div id="blogtitle" class="blogtitle">mrT4ntr4&#39;s Blog</div>
<ul id="wrapper" class="wrapper">
  <div class="sun">
    <div class="star"></div>
  </div>
  <div class="mercury">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="venus">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="earth">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="mars">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="jupiter">
    <div class="planet"><div class="shadow"></div></div>
  </div>
</ul>
</div>

    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
         
          <li><a href="/categories/">Category</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/Noverify-Java-Crackme-3/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-1/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&text=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&is_video=false&description=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II&body=Check out this article: https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&name=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&t=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Some-Tidbits"><span class="toc-number">1.</span> <span class="toc-text">Some Tidbits</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Stealing-Credentials"><span class="toc-number">2.</span> <span class="toc-text">Stealing Credentials</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Communication-through-SMTP"><span class="toc-number">3.</span> <span class="toc-text">Communication through SMTP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Thanks"><span class="toc-number">4.</span> <span class="toc-text">Thanks</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Suraj Malhotra</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-04-15T01:00:00.000Z" itemprop="datePublished">2020-04-15</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/MalwareAnalysis/">MalwareAnalysis</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Net/" rel="tag">.Net</a>, <a class="tag-link-link" href="/tags/AgentTesla/" rel="tag">AgentTesla</a>, <a class="tag-link-link" href="/tags/Malware/" rel="tag">Malware</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"<p><a href="/img/MA/sample1/thumb2.png" title="banner" class="gallery-item"><img src="/img/MA/sample1/thumb2.png" alt="banner"></a></p>
<p>I hope you’ve read the <a href="/How-Analysing-an-AgentTesla-Gives-Access-To-Attackers-Inbox-1/">Part I</a> of this series.<br>There we discussed some techniques to do basic analysis, tested the sample on any.run and most importantly the “Decrypting Strings” part where we learned how it uses AES encrypted strings to evade some simple detections.   </p>
<p>So Lets get started !!  </p>
<h1 id="Some-Tidbits"><a href="#Some-Tidbits" class="headerlink" title="Some Tidbits"></a>Some Tidbits</h1><p>To continue with where we left earlier, the next fcn called is <em>tlg()</em> and it copies the malware into the default temporary location as <strong>TMP#{Millisecond}.bin</strong>  </p>
<p><a href="/img/MA/sample1/e27.PNG"><a href="/img/MA/sample1/e27.PNG" title="e27" class="gallery-item"><img src="/img/MA/sample1/e27.PNG" alt="e27"></a></a>  </p>
<p>Later it starts to execute the fcn <em>tkq.tjg</em> in a thread.  </p>
<p><a href="/img/MA/sample1/e28.PNG"><a href="/img/MA/sample1/e28.PNG" title="e28" class="gallery-item"><img src="/img/MA/sample1/e28.PNG" alt="e28"></a></a>  </p>
<p>It uses <em>tkq.tjg</em> to perform some registry key modifications usually for persistence and execute some system commands.<br>It uses that temporary file it just created as well.  </p>
<p><a href="/img/MA/sample1/e29.PNG"><a href="/img/MA/sample1/e29.PNG" title="e29" class="gallery-item"><img src="/img/MA/sample1/e29.PNG" alt="e29"></a></a>  </p>
<p><a href="/img/MA/sample1/e30.PNG"><a href="/img/MA/sample1/e30.PNG" title="e30" class="gallery-item"><img src="/img/MA/sample1/e30.PNG" alt="e30"></a></a>  </p>
<hr>
<h1 id="Stealing-Credentials"><a href="#Stealing-Credentials" class="headerlink" title="Stealing Credentials"></a>Stealing Credentials</h1><a target="_blank" rel="noopener" href="https://media.giphy.com/media/cjT17PDuM7azm/giphy.gif" title="drawing" class="gallery-item"><img src="https://media.giphy.com/media/cjT17PDuM7azm/giphy.gif" alt="drawing" width="300"/></a>   

<p>PS This is the core part of the series and its important to understand.  </p>
<p>So, The next function to notice is <em>kqe</em> which returns a list.<br>The first statement gets the path to the AppData/Local.  </p>
<p><a href="/img/MA/sample1/e31.PNG"><a href="/img/MA/sample1/e31.PNG" title="e31" class="gallery-item"><img src="/img/MA/sample1/e31.PNG" alt="e31"></a></a>  </p>
<p>Then the execution is passed to <em>zla.zgh</em> with the location of Chrome concatenated with the AppData location.  </p>
<p><a href="/img/MA/sample1/e32.PNG"><a href="/img/MA/sample1/e32.PNG" title="e32" class="gallery-item"><img src="/img/MA/sample1/e32.PNG" alt="e32"></a></a>  </p>
<p>It also concatenates <em>\Default\Login Data</em> and <em>\Login Data</em> and saves those 2 results in a list.<br>Next it looks whether the Directory <strong>User Data</strong> exists in the particular location.  </p>
<p><a href="/img/MA/sample1/e33.PNG"><a href="/img/MA/sample1/e33.PNG" title="e33" class="gallery-item"><img src="/img/MA/sample1/e33.PNG" alt="e33"></a></a>  </p>
<p><a href="/img/MA/sample1/e34.PNG"><a href="/img/MA/sample1/e34.PNG" title="e34" class="gallery-item"><img src="/img/MA/sample1/e34.PNG" alt="e34"></a></a>  </p>
<p>If the directory is present, it iterates over it to find its subdirectories.  </p>
<p><a href="/img/MA/sample1/e35.PNG"><a href="/img/MA/sample1/e35.PNG" title="e35" class="gallery-item"><img src="/img/MA/sample1/e35.PNG" alt="e35"></a></a>  </p>
<p>And at last compares if the string <strong>Profile</strong> is present in any of the items in the directories list.<br>Basically It checks if any subdirectory named Profile exists. This could be the case when I would have installed other browsers such as Firefox, etc. </p>
<p>PS I only have only installed Chrome on my Victim VM and We’ll be only exploring the process of credential stealer in case of Chrome.  </p>
<p><a href="/img/MA/sample1/e36.PNG"><a href="/img/MA/sample1/e36.PNG" title="e36" class="gallery-item"><img src="/img/MA/sample1/e36.PNG" alt="e36"></a></a>  </p>
<p><a href="/img/MA/sample1/e37.PNG"><a href="/img/MA/sample1/e37.PNG" title="e37" class="gallery-item"><img src="/img/MA/sample1/e37.PNG" alt="e37"></a></a>  </p>
<p>Finally It checks for the real <strong>Login Data</strong> file in both locations <strong>User Data\Default\</strong>, <strong>\User Data\</strong> (from items of prev list) and if it exists it executes fcn. <strong>emx</strong>. </p>
<p><a href="/img/MA/sample1/e38.PNG"><a href="/img/MA/sample1/e38.PNG" title="e38" class="gallery-item"><img src="/img/MA/sample1/e38.PNG" alt="e38"></a></a>  </p>
<p>Now vcx contains the content of the <em>Login Data</em> file.  </p>
<p><a href="/img/MA/sample1/e59.PNG"><a href="/img/MA/sample1/e59.PNG" title="e59" class="gallery-item"><img src="/img/MA/sample1/e59.PNG" alt="e59"></a></a>   </p>
<p>The <em>emx</em> function is interesting.<br>TBH I didn’t had any installation of Chrome on my VM but this function looks like it does a strict checking on the contents of the <em>Login Data</em> file and I needed to get a legitimate one.  </p>
<p>So First it wants the 52th byte in the file to be 0.<br>Then it compares var <em>vjl</em> to 0.<br>For <em>vjl</em> we need to analyse <em>eco</em> fcn and I found out it just returns ‘arg2’ no. of bytes starting from ‘arg1’ index from <em>vcx</em>.  </p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">emx</span>(<span class="params"><span class="built_in">string</span> baseName</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.vja = <span class="keyword">new</span> <span class="built_in">byte</span>[]&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span> (File.Exists(baseName))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.vcx = <span class="keyword">this</span>.vcl(baseName); <span class="comment">// vcx = file contents</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.vcx[<span class="number">52</span>] != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.vjo = checked((<span class="built_in">ushort</span>)<span class="keyword">this</span>.eco(<span class="number">16</span>, <span class="number">2</span>));  <span class="comment">// 2 chars from vcx[16]</span></span><br><span class="line">        <span class="keyword">this</span>.vjl = <span class="keyword">this</span>.eco(<span class="number">56</span>, <span class="number">4</span>);   <span class="comment">// 4 chars from vcx[56]</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">decimal</span>.Compare(<span class="keyword">new</span> <span class="built_in">decimal</span>(<span class="keyword">this</span>.vjl), <span class="number">0</span>m) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.vjl = <span class="number">1U</span>L;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.ejo(<span class="number">100U</span>L);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If it succeeds and passes all of the checks, control is passed over to fcn <strong>ejo</strong>.<br>The <em>ejo</em> fcn is cool as I thought that it would execute sql queries over the <em>Login Data</em> file to get the credentials but there is no need of doing this, we’ll see how :)<br>First It creates an obj list with 5 elements and has main elements as <em>item_name</em>, <em>item_type</em>,<em>sql_statement</em>. These all fields are filled by taking strings from different indexes from the original <em>Login Data</em> file.  </p>
<p><a href="/img/MA/sample1/e39.PNG"><a href="/img/MA/sample1/e39.PNG" title="e39" class="gallery-item"><img src="/img/MA/sample1/e39.PNG" alt="e39"></a></a>  </p>
<p><a href="/img/MA/sample1/e40.PNG"><a href="/img/MA/sample1/e40.PNG" title="e40" class="gallery-item"><img src="/img/MA/sample1/e40.PNG" alt="e40"></a></a>  </p>
<p><a href="/img/MA/sample1/e41.PNG"><a href="/img/MA/sample1/e41.PNG" title="e41" class="gallery-item"><img src="/img/MA/sample1/e41.PNG" alt="e41"></a></a>  </p>
<p>Also I don’t know why but <strong>ejo</strong> first adds data to the beginning 6 elements of <em>vjb</em> and then another loop adds 11 elements to it and fills them.  </p>
<blockquote>
<p>View whole content of vjb <a href="/files/MA/sample1/vjb.txt">here</a>. </p>
</blockquote>
<p><a href="/img/MA/sample1/e42.PNG"><a href="/img/MA/sample1/e42.PNG" title="e42" class="gallery-item"><img src="/img/MA/sample1/e42.PNG" alt="e42"></a></a>  </p>
<p>Next It searches for vjb[2] element and extracts all the words within parantheses and splits them with ‘,’ as a delimiter from the sql_statement.  </p>
<p><a href="/img/MA/sample1/e44.PNG"><a href="/img/MA/sample1/e44.PNG" title="e44" class="gallery-item"><img src="/img/MA/sample1/e44.PNG" alt="e44"></a></a>  </p>
<p>The resulting list looks like the following…<br>Also it strips the spaces which we can notice at the beginning now.<br><a href="/img/MA/sample1/e45.PNG"><a href="/img/MA/sample1/e45.PNG" title="e45" class="gallery-item"><img src="/img/MA/sample1/e45.PNG" alt="e45"></a></a>  </p>
<p>Now the resulting list is copied into the <em>vjh</em> array.  </p>
<p><a href="/img/MA/sample1/e46.PNG"><a href="/img/MA/sample1/e46.PNG" title="e46" class="gallery-item"><img src="/img/MA/sample1/e46.PNG" alt="e46"></a></a>  </p>
<p>Afterwards it iterates over its elements, splits them with “ “ as a delimiter and then only keeps the first element.  </p>
<p><a href="/img/MA/sample1/e48.PNG"><a href="/img/MA/sample1/e48.PNG" title="e48" class="gallery-item"><img src="/img/MA/sample1/e48.PNG" alt="e48"></a></a>  </p>
<p>The resulting array looks like the following..   </p>
<p><a href="/img/MA/sample1/e47.PNG"><a href="/img/MA/sample1/e47.PNG" title="e47" class="gallery-item"><img src="/img/MA/sample1/e47.PNG" alt="e47"></a></a>  </p>
<p>Now it initialises another array as <em>vjg</em> and has the structure from emx.emg.  </p>
<p><a href="/img/MA/sample1/e52.PNG"><a href="/img/MA/sample1/e52.PNG" title="e52" class="gallery-item"><img src="/img/MA/sample1/e52.PNG" alt="e52"></a></a>  </p>
<p>As you can see below it has a single element with two fields as <em>content</em> &amp; <em>row_id</em>. From this point I can guess that the content field is what we are looking for.   </p>
<p><a href="/img/MA/sample1/e53.PNG"><a href="/img/MA/sample1/e53.PNG" title="e53" class="gallery-item"><img src="/img/MA/sample1/e53.PNG" alt="e53"></a></a>  </p>
<p>Also another variable <em>array</em> is initialised with the structure of emx.ema.<br>Its elements have a <em>size</em> &amp; <em>type</em> field.  </p>
<p><a href="/img/MA/sample1/e54.PNG"><a href="/img/MA/sample1/e54.PNG" title="e54" class="gallery-item"><img src="/img/MA/sample1/e54.PNG" alt="e54"></a></a>  </p>
<p>And it fills both of them with some calculations done on obj2 and obj4.  </p>
<p><a href="/img/MA/sample1/gg1.PNG"><a href="/img/MA/sample1/gg1.PNG" title="gg1" class="gallery-item"><img src="/img/MA/sample1/gg1.PNG" alt="gg1"></a></a><br><a href="/img/MA/sample1/gg2.PNG"><a href="/img/MA/sample1/gg2.PNG" title="gg2" class="gallery-item"><img src="/img/MA/sample1/gg2.PNG" alt="gg2"></a></a>  </p>
<p>And it iterates till an element with type &gt; 9 exists in the array. </p>
<p><a href="/img/MA/sample1/gg3.PNG"><a href="/img/MA/sample1/gg3.PNG" title="gg3" class="gallery-item"><img src="/img/MA/sample1/gg3.PNG" alt="gg3"></a></a>  </p>
<p>Some of the elements are as follows..<br>We’ll see how is it used now.    </p>
<p><a href="/img/MA/sample1/e55.PNG"><a href="/img/MA/sample1/e55.PNG" title="e55" class="gallery-item"><img src="/img/MA/sample1/e55.PNG" alt="e55"></a></a>  </p>
<p>After this, it initialises the content field of vjg and we can see that it’ll have the same number of elements as of array. Hmm.. Looks like some operation will be done on array.  </p>
<p><a href="/img/MA/sample1/e56.PNG"><a href="/img/MA/sample1/e56.PNG" title="e56" class="gallery-item"><img src="/img/MA/sample1/e56.PNG" alt="e56"></a></a>  </p>
<p>And Woah.. after some loops we can observe that it was successful in extracting some strings from the sqlite <em>Login Data</em> file.  </p>
<p><a href="/img/MA/sample1/e57.PNG"><a href="/img/MA/sample1/e57.PNG" title="e57" class="gallery-item"><img src="/img/MA/sample1/e57.PNG" alt="e57"></a></a>  </p>
<p>Now lets dig into what happened with the array and what it did behind the scenes.  </p>
<p>So the statement in the above screenshot looks like the following.  </p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.vjg[num8 + num5].content[num13] = Encoding.Default.GetString(</span><br><span class="line">                    <span class="keyword">this</span>.vcx,</span><br><span class="line">                    Convert.ToInt32(</span><br><span class="line">                            <span class="built_in">decimal</span>.Add(</span><br><span class="line">                                <span class="built_in">decimal</span>.Add(</span><br><span class="line">                                    <span class="keyword">new</span> <span class="built_in">decimal</span>(num6), <span class="keyword">new</span> <span class="built_in">decimal</span>(num14)),</span><br><span class="line">                                <span class="keyword">new</span> <span class="built_in">decimal</span>(num15))),</span><br><span class="line">                    (<span class="built_in">int</span>)array[num13].size);</span><br></pre></td></tr></table></figure>
<p>Now at this point we can utilise the Locals window to check the values of some variables including num8, num5, num13, num6, num14, num15.  </p>
<p>I made some notes and added a watch over those variables.<br>As anybody can tell that num13 is the index of the content field but I noticed that num8, num5, num6, num14 remained the same for every value of num13.<br>So its basically accessing data from a particular index which is (num6 + num14 + num15) out of which (num6 + num14) is a constant, for me ie.  6797 so the only index to note is num15.<br>Also if you’d observe that array[x].size is what we previously initialised for every item in the array and its basically the string length record.  </p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vjg[<span class="number">0</span>].content[<span class="number">0x2</span>] = (<span class="keyword">this</span>.vcx, <span class="number">6797</span> + num15, <span class="number">0x8</span>)  <span class="comment">//&quot;username&quot; str</span></span><br><span class="line">then num15 = <span class="number">0x3e</span></span><br><span class="line">vjg[<span class="number">0</span>].content[<span class="number">0x3</span>] = (<span class="keyword">this</span>.vcx, <span class="number">6797</span> + num15, <span class="number">0xf</span>)  <span class="comment">//username</span></span><br><span class="line">then num15 = <span class="number">0x46</span></span><br><span class="line">vjg[<span class="number">0</span>].content[<span class="number">0x4</span>] = (<span class="keyword">this</span>.vcx, <span class="number">6797</span> + num15, <span class="number">0x8</span>)  <span class="comment">//&quot;password&quot; str</span></span><br><span class="line">num15 = <span class="number">0x4e</span></span><br><span class="line">vjg[<span class="number">0</span>].content[<span class="number">0x5</span>] = (<span class="keyword">this</span>.vcx, <span class="number">6797</span> + num15, <span class="number">0x30</span>) <span class="comment">//password</span></span><br><span class="line">num15 = <span class="number">0x74</span></span><br><span class="line">vjg[<span class="number">0</span>].content[<span class="number">0x6</span>] = (<span class="keyword">this</span>.vcx, <span class="number">6797</span> + num15, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>After the function ends we get to see every item in the locals.  </p>
<p><a href="/img/MA/sample1/e58.PNG"><a href="/img/MA/sample1/e58.PNG" title="e58" class="gallery-item"><img src="/img/MA/sample1/e58.PNG" alt="e58"></a></a> </p>
<p>Ahmm.. we get it on some functions as listed below. Now you know what to do.. Set a Breakpoint on them where they use it this deadly API Call :)<br>Now everybody knows there is only one way to decrypt that password from <em>Login Data</em> ie <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/dpapi/nf-dpapi-cryptunprotectdata">CryptUnprotectData</a> fcn Call. So I searched for any references to where its used..  </p>
<p><a href="/img/MA/sample1/e60.PNG"><a href="/img/MA/sample1/e60.PNG" title="e60" class="gallery-item"><img src="/img/MA/sample1/e60.PNG" alt="e60"></a></a>  </p>
<p>And BoomYa we hit one of them and we can also see our encrypted password in the locals window. Now we can copy the result from this call from this local by simply stepping into it.  </p>
<p><a href="/img/MA/sample1/e61.PNG"><a href="/img/MA/sample1/e61.PNG" title="e61" class="gallery-item"><img src="/img/MA/sample1/e61.PNG" alt="e61"></a></a><br>But wait thats not it.. Sh*t It has a whole function to decrypt it too to which it has passed the result of unprotected data and our original encrypted password.<br>This was something new for me coz I’m not use to C# and the decryption function in C looks very <a href="/files/MA/sample1/crackPass.c">different</a>.  </p>
<p>What I can observe from this is that it uses AES_GCM mode but don’t know the use of BCRYPT here. (Maybe It is the only one to include AES GCM Mode) <strong>¯\_(ツ)_/¯</strong>   </p>
<p><a href="/img/MA/sample1/e62.PNG"><a href="/img/MA/sample1/e62.PNG" title="e62" class="gallery-item"><img src="/img/MA/sample1/e62.PNG" alt="e62"></a></a>  </p>
<p>And Then fortunately I found some <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/60640302/system-security-cryptography-cryptographicexception-the-parameter-is-incorrect">reference</a> which made my task easy.<br>I was finally successful to implement this in <a target="_blank" rel="noopener" href="https://pycryptodome.readthedocs.io/en/latest/src/cipher/modern.html#gcm-mode">python</a>. </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">pwd, unproc_key</span>):</span></span><br><span class="line">    auth_tag = pwd[-<span class="number">16</span>:]</span><br><span class="line">    pwd = pwd.replace(auth_tag,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    nonce, proc_pwd = pwd[<span class="number">3</span>:<span class="number">15</span>], pwd[<span class="number">15</span>:]</span><br><span class="line">    cipher = AES.new(unproc_key, AES.MODE_GCM, nonce=nonce)</span><br><span class="line">    <span class="built_in">print</span> cipher.decrypt_and_verify(proc_pwd,auth_tag)</span><br><span class="line"></span><br><span class="line">pwd = <span class="string">&quot;763130492BD2706140CDA41C2701F3B4C2B5153DE018BA5512897731F1A1BB7D7982AA2BF3DEA4B299145D88B040ED58&quot;</span>.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">unproc_key = <span class="string">&quot;2295D977B8F09202A4F8F7ACAF15C1B9EC411B126A0335208BE3DB8F14CA1551&quot;</span>.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">dec(pwd, unproc_key)</span><br></pre></td></tr></table></figure>
<p>Moving on, It creates another list <em>zah</em> where its elements have 3 fields named Item1, Item2 and Item3.<br>Here,<br>Item1 = Browser Name<br>Item2 = Browser Data Location<br>item3 = bool if it exists (maybe)  </p>
<p><a href="/img/MA/sample1/e63.PNG"><a href="/img/MA/sample1/e63.PNG" title="e63" class="gallery-item"><img src="/img/MA/sample1/e63.PNG" alt="e63"></a></a>  </p>
<p>Next It checks if whether it exists or not similarly it checked the chrome location.  </p>
<p><a href="/img/MA/sample1/e64.PNG"><a href="/img/MA/sample1/e64.PNG" title="e64" class="gallery-item"><img src="/img/MA/sample1/e64.PNG" alt="e64"></a></a>  </p>
<p>But now It doesn’t do anything (I don’t have Opera installed), instead I see the credentials from Chrome being added to a list. Now we have the decrypted password in it :)  </p>
<p><a href="/img/MA/sample1/e65.PNG"><a href="/img/MA/sample1/e65.PNG" title="e65" class="gallery-item"><img src="/img/MA/sample1/e65.PNG" alt="e65"></a></a>  </p>
<p>Later it continues to check for different browsers and some FTP Clients as well.  </p>
<p><a href="/img/MA/sample1/e67.PNG"><a href="/img/MA/sample1/e67.PNG" title="e67" class="gallery-item"><img src="/img/MA/sample1/e67.PNG" alt="e67"></a></a>  </p>
<p>And After adding some of the Browser Names &amp; Location it checks for them in chunks.<br>Here you can check it does the same process with Yandex Browser.  </p>
<p><a href="/img/MA/sample1/e68.PNG"><a href="/img/MA/sample1/e68.PNG" title="e68" class="gallery-item"><img src="/img/MA/sample1/e68.PNG" alt="e68"></a></a>  </p>
<hr>
<h1 id="Communication-through-SMTP"><a href="#Communication-through-SMTP" class="headerlink" title="Communication through SMTP"></a>Communication through SMTP</h1><p>Now we know some part of how it carries out its stealthy process of stealing credentials from the browswers without any sql query. So I ended up searching for some functions which used the SMTP client responsible for sending the credentials.  </p>
<p>And I found the only function which used it was <em>tkq.tyx()</em>.<br>Luckily It was not as obfuscated as I thought it to be.  </p>
<p><a href="/img/MA/sample1/e69.PNG"><a href="/img/MA/sample1/e69.PNG" title="e69" class="gallery-item"><img src="/img/MA/sample1/e69.PNG" alt="e69"></a></a>  </p>
<p>We can clearly observe our system and browser information which its sending over.<br>Along with them we can also see the plaintext credentials of the author’s email account at yandex.ru which is used to send it.<br>And to no surprise, these credentials were working as we previously checked the any.run results.   </p>
<a target="_blank" rel="noopener" href="https://media.giphy.com/media/OdHeYw7XBk6EE/giphy.gif" title="drawing" class="gallery-item"><img src="https://media.giphy.com/media/OdHeYw7XBk6EE/giphy.gif" alt="drawing" width="300"/></a>  

<p>Also The funny thing is that I had the credentials before this part of the blog as they were just decrypted using the same process I explained.  </p>
<p><a href="/img/MA/sample1/e70.PNG"><a href="/img/MA/sample1/e70.PNG" title="e70" class="gallery-item"><img src="/img/MA/sample1/e70.PNG" alt="e70"></a></a>  </p>
<p>We can view our browser credentials in memory dump and the message body is formatted as html.  </p>
<p><a href="/img/MA/sample1/e71.PNG"><a href="/img/MA/sample1/e71.PNG" title="e71" class="gallery-item"><img src="/img/MA/sample1/e71.PNG" alt="e71"></a></a>  </p>
<p>It uses different classes such as mailMessage to construct the message body.<br>And Finally It initializes some other variables such as..<br>Port = 587 (default for SMTP)<br>Host = yandex.ru,<br>To and From fields were the same…   </p>
<p><a href="/img/MA/sample1/e72.PNG"><a href="/img/MA/sample1/e72.PNG" title="e72" class="gallery-item"><img src="/img/MA/sample1/e72.PNG" alt="e72"></a></a>  </p>
<p>And when it sends over the data it deletes itself from the disk. I didn’t explore it that much and I wasn’t sure maybe it was executed in a thread.  </p>
<hr>
<h1 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h1><p>I hope this 2 part series was insightful and you guys enjoyed it. Well If you are reading this line you really liked it.<br>TBH It really took a lot of work to put it all together including taking screenshots, and not to forget… opening the malware again in dnspy.. everytime it removed itself.  </p>
<p>See ya guys next time…<br>Till then Take Care and make use of this Lockdown to learn new stuff.<br>Also Keep sharing your findings with the community.</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
         
          <li><a href="/categories/">Category</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Some-Tidbits"><span class="toc-number">1.</span> <span class="toc-text">Some Tidbits</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Stealing-Credentials"><span class="toc-number">2.</span> <span class="toc-text">Stealing Credentials</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Communication-through-SMTP"><span class="toc-number">3.</span> <span class="toc-text">Communication through SMTP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Thanks"><span class="toc-number">4.</span> <span class="toc-text">Thanks</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&text=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&is_video=false&description=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II&body=Check out this article: https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&title=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&name=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://mrt4ntr4.github.io/How-Analysing-an-AgentTesla-Could-Lead-To-Attackers-Inbox-2/&t=How Analysing an AgentTesla Could Lead To Attackers Inbox - Part II"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021-2023
    Suraj Malhotra
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
         
          <li><a href="/categories/">Category</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"CTRL+C\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
      setTimeout(function() {
        e.trigger.setAttribute('aria-label', "CTRL+C");
      }, 2000);
    })
  })
  </script>


<script src="/js/main.js"></script>





    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-132815766-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-132815766-1');
    </script>








</body>
</html>
